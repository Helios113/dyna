model_config:
  d_model: 412
  n_layers: 16
  n_heads: 4
  n_ffn_experts: 180
  n_att_experts: 8
  d_head: 84
  ff_k: 12
  ff_expert_size: 188
  group_size: 2
  vocab_size: 49152
  max_seq_len: 1024
  scale_add: True
  prot_emb: True

train:
  max_duration: "3872ba"
  warmup:  "774ba"
  cooldown: "774ba"


callbacks:
    speed_monitor:
      window_size: 10
    lr_monitor: {}
    memory_monitor: {}
    runtime_estimator: {}
    optimizer_monitor: {}
    activation_monitor_c: {}

data_config:
  path: "/nfs-share/pa511/code_bases/dyna_project/dyna/configuration/streams_small"
  dataset:
    max_seq_len: ${model_config.max_seq_len}

trainer_config:
  max_duration: ${train.max_duration}
  eval_interval: 100ba
  eval_subset_num_batches: -1
  train_dataloader_label: "train"
  device_train_microbatch_size: auto
  precision: "amp_bf16"
  device: "gpu"
  parallelism_config:
    pipeline_parallel_size: null
    tensor_parallel_size: null

scheduler_config:
  name: "wsld"
  t_warmup: ${train.warmup}
  t_max: ${train.max_duration}
  t_cooldown: ${train.cooldown}
  alpha_f: 1.0
